# **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã ‚Ññ48**

## **5.1 –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API**

### **1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ API services**
–°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç —Ç–∏–ø–∞ **Class Library (.NET Core)** —Å –∏–º–µ–Ω–µ–º `GameApiService`.  

### **2. –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞ `GamesService`**
```csharp
using System.Net.Http.Json;
using System.Net.Http;

public class GamesService
{
    private readonly HttpClient _httpClient;

    // –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —Å –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ–º HttpClient
    public GamesService(HttpClient httpClient)
    {
        _httpClient = httpClient;
    }

    // –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∏–≥—Ä
    public async Task<List<Game>> GetGamesAsync()
    {
        return await _httpClient.GetFromJsonAsync<List<Game>>("api/games") ?? new List<Game>();
    }

    // –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–≥—Ä—ã –ø–æ ID
    public async Task<Game?> GetGameByIdAsync(int id)
    {
        return await _httpClient.GetFromJsonAsync<Game>($"api/games/{id}");
    }

    // –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –∏–≥—Ä—ã
    public async Task AddGameAsync(Game game)
    {
        await _httpClient.PostAsJsonAsync("api/games", game);
    }

    // –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–≥—Ä—ã
    public async Task UpdateGameAsync(int id, Game game)
    {
        await _httpClient.PutAsJsonAsync($"api/games/{id}", game);
    }

    // –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∏–≥—Ä—ã
    public async Task DeleteGameAsync(int id)
    {
        await _httpClient.DeleteAsync($"api/games/{id}");
    }
}

// –ú–æ–¥–µ–ª—å Game
public class Game
{
    public int Id { get; set; }
    public string? Name { get; set; }
    public decimal Price { get; set; }
    public string? Description { get; set; }
}
```

---

## **5.2 –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞**

### **1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞**
–°–æ–∑–¥–∞–µ–º **Console App (.NET Core)** —Å –∏–º–µ–Ω–µ–º `GameConsoleClient`.  

### **2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `HttpClient` –∏ –≤—ã–∑–æ–≤ –º–µ—Ç–æ–¥–æ–≤ `GamesService`**
```csharp
using System;
using System.Threading.Tasks;

class Program
{
    static async Task Main(string[] args)
    {
        var httpClient = new HttpClient
        {
            BaseAddress = new Uri("https://localhost:5001/") // –ë–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å API
        };

        var gamesService = new GamesService(httpClient);

        try
        {
            // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä
            var games = await gamesService.GetGamesAsync();
            Console.WriteLine("–°–ø–∏—Å–æ–∫ –∏–≥—Ä:");
            foreach (var game in games)
            {
                Console.WriteLine($"{game.Id}: {game.Name} - {game.Price}$");
            }

            // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∏–≥—Ä—ã
            var newGame = new Game { Name = "New Game", Price = 59.99m };
            await gamesService.AddGameAsync(newGame);
            Console.WriteLine("–ò–≥—Ä–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞!");

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–≥—Ä—ã
            var updatedGame = new Game { Name = "Updated Game", Price = 49.99m };
            await gamesService.UpdateGameAsync(1, updatedGame);
            Console.WriteLine("–ò–≥—Ä–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞!");

            // –£–¥–∞–ª–µ–Ω–∏–µ –∏–≥—Ä—ã
            await gamesService.DeleteGameAsync(1);
            Console.WriteLine("–ò–≥—Ä–∞ —É–¥–∞–ª–µ–Ω–∞!");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"–û—à–∏–±–∫–∞: {ex.Message}");
        }
    }
}
```

---

## **5.3 –°–æ–∑–¥–∞–Ω–∏–µ –≤–µ–±-–∫–ª–∏–µ–Ω—Ç–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö**

### **1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ "–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ASP.NET Core" (Razor Pages)**
–°–æ–∑–¥–∞–µ–º **ASP.NET Core Web App (Razor Pages)** —Å –∏–º–µ–Ω–µ–º `GameWebClient`.  

### **2. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è `GamesService` –≤ `Program.cs`**
```csharp
var builder = WebApplication.CreateBuilder(args);

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ HttpClient –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è GamesService
builder.Services.AddHttpClient<GamesService>(client =>
{
    client.BaseAddress = new Uri("https://localhost:5001/");
});

builder.Services.AddRazorPages();
var app = builder.Build();
```

### **3. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä (`Index.cshtml`)**
```html
@page
@model IndexModel
@{
    ViewData["Title"] = "–°–ø–∏—Å–æ–∫ –∏–≥—Ä";
}

<h1>–°–ø–∏—Å–æ–∫ –∏–≥—Ä</h1>

<table class="table">
    <thead>
        <tr>
            <th>ID</th>
            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
            <th>–¶–µ–Ω–∞</th>
            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var game in Model.Games)
        {
            <tr>
                <td>@game.Id</td>
                <td>@game.Name</td>
                <td>@game.Price</td>
                <td>
                    <a asp-page="/Details" asp-route-id="@game.Id" class="btn btn-info">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                    <form method="post" asp-page-handler="Delete" asp-route-id="@game.Id">
                        <button type="submit" class="btn btn-danger">–£–¥–∞–ª–∏—Ç—å</button>
                    </form>
                </td>
            </tr>
        }
    </tbody>
</table>

<a asp-page="/Create" class="btn btn-success">–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∏–≥—Ä—É</a>
```

### **4. –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º (`Details.cshtml`)**
```html
@page
@model DetailsModel
@{
    ViewData["Title"] = "–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –∏–≥—Ä—ã";
}

<h1>@Model.Game.Name</h1>
<p>–¶–µ–Ω–∞: @Model.Game.Price</p>
<p>–û–ø–∏—Å–∞–Ω–∏–µ: @Model.Game.Description</p>

<a asp-page="/Edit" asp-route-id="@Model.Game.Id" class="btn btn-warning">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
<a asp-page="/Index" class="btn btn-secondary">–ù–∞–∑–∞–¥</a>
```

---

## **5.4 –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –≤–µ–±-–∫–ª–∏–µ–Ω—Ç–µ**

### **1. –£–¥–∞–ª–µ–Ω–∏–µ –∏–≥—Ä—ã (`Index.cshtml.cs`)**
```csharp
public class IndexModel : PageModel
{
    private readonly GamesService _gamesService;

    public IndexModel(GamesService gamesService)
    {
        _gamesService = gamesService;
    }

    public List<Game> Games { get; set; } = new();

    public async Task OnGetAsync()
    {
        Games = await _gamesService.GetGamesAsync();
    }

    public async Task<IActionResult> OnPostDeleteAsync(int id)
    {
        await _gamesService.DeleteGameAsync(id);
        return RedirectToPage();
    }
}
```

### **2. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–≥—Ä—ã (`Edit.cshtml`)**
```html
@page
@model EditModel
@{
    ViewData["Title"] = "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–≥—Ä—ã";
}

<h1>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–≥—Ä—ã</h1>

<form method="post">
    <input type="hidden" asp-for="Game.Id" />
    <div class="form-group">
        <label asp-for="Game.Name"></label>
        <input asp-for="Game.Name" class="form-control" />
    </div>
    <div class="form-group">
        <label asp-for="Game.Price"></label>
        <input asp-for="Game.Price" class="form-control" />
    </div>
    <div class="form-group">
        <label asp-for="Game.Description"></label>
        <textarea asp-for="Game.Description" class="form-control"></textarea>
    </div>
    <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
</form>
```

### **3. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∏–≥—Ä—ã (`Create.cshtml`)**
```html
@page
@model CreateModel
@{
    ViewData["Title"] = "–°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä—ã";
}

<h1>–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∏–≥—Ä—ã</h1>

<form method="post">
    <div class="form-group">
        <label asp-for="Game.Name"></label>
        <input asp-for="Game.Name" class="form-control" />
    </div>
    <div class="form-group">
        <label asp-for="Game.Price"></label>
        <input asp-for="Game.Price" class="form-control" />
    </div>
    <div class="form-group">
        <label asp-for="Game.Description"></label>
        <textarea asp-for="Game.Description" class="form-control"></textarea>
    </div>
    <button type="submit" class="btn btn-success">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
</form>
```

---

## **–í—ã–≤–æ–¥**
–í —Ö–æ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã:
- –°–æ–∑–¥–∞–Ω **—Å–µ—Ä–≤–∏—Å `GamesService`** –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å API.
- –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω **–∫–æ–Ω—Å–æ–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç** –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API.
- –°–æ–∑–¥–∞–Ω–æ **–≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –Ω–∞ Razor Pages —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é:
  - –ü—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä.
  - –ü—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–µ—Ç–∞–ª–µ–π –∏–≥—Ä—ã.
  - –î–æ–±–∞–≤–ª–µ–Ω–∏—è, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —É–¥–∞–ª–µ–Ω–∏—è –∏–≥—Ä.
  
–†–∞–±–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏. üöÄ
